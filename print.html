<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>封筒印刷</title>
  <style>
    @page {
      size: 240mm 332mm;
      margin: 0;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: "MS PGothic", sans-serif;
    }

    #addressBox {
      position: absolute;
      top: 100mm;       /* 宛名の上位置 */
      left: 40mm;       /* 左端からの位置 */
      font-size: 16pt;
      line-height: 1.8;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div id="addressBox">読み込み中...</div>

  <script>
    function getParam(name) {
      return decodeURIComponent((new URLSearchParams(window.location.search)).get(name) || "");
    }

    const postal = getParam("postal");
    const prefecture = getParam("pref");
    const city = getParam("city");
    const company = getParam("company");
    const person = getParam("person");

    let addressText = `〒${postal}\n${prefecture}${city}\n${company}`;
    if (person) {
      addressText += `\n${person} 様`;
    } else {
      addressText += ` 御中`;
    }

    document.getElementById("addressBox").innerText = addressText;

    setTimeout(() => window.print(), 800);
  </script>
</body>
</html>
